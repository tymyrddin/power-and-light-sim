# config/firewall.yml
# Firewall baseline configuration
#
# Changes to this file require restart:
#   python tools/simulator_manager.py
#
# For runtime changes (incident response), use API:
#   await firewall.add_rule(...)

# Default policy for traffic not matching any rule
# Options: allow, deny
default_action: allow  # Vulnerable by default for initial exercises

# Baseline firewall rules
# These are loaded on startup and persist across restarts
# Priority: Lower number = higher priority (checked first)
baseline_rules:
  # Purdue Model segmentation: block direct enterprise → control zone traffic
  # Enable via: blue_team.py firewall enable-rule <id>
  # Or set enabled: true here and restart the simulator
  - name: "Segmentation: Block enterprise to control"
    action: DROP
    priority: 100
    source_zone: enterprise_zone
    dest_zone: control_zone
    protocol: ANY
    enabled: false  # Disabled by default (vulnerable for initial exercises)
    description: "Purdue Model - no direct enterprise to control zone access"

  # Example: Allow SCADA to PLCs (uncomment when blocking enterprise→control)
  # - name: "Baseline: Allow SCADA operations"
  #   action: ALLOW
  #   priority: 50        # Higher priority than block rules
  #   source_zone: operations_zone
  #   dest_zone: control_zone
  #   protocol: modbus_tcp
  #   enabled: true
  #   description: "Normal operations - SCADA must reach PLCs"

# Note: Runtime rules added via API (incident response) are NOT saved here
# To make runtime rules permanent, add them to this file and restart